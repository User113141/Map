let isPlacing = false;let isDeleteMode = false;let selectedStructure = null;let currentRotation = 0;const structureIcons = ['wooden-repair-tower.png', 'wooden-fire-tower.png', 'wooden-wall.png','wooden-door.png', 'wooden-water-tower.png', 'wooden-windmill-small.png','wooden-spike.png', 'wooden-spectrum-tower.png', 'wooden-electric-tower.png','wooden-plant-tower.png', 'wooden-rock-tower.png', 'wooden-ice-tower.png','mega-resurrection-stone.png', 'resurrection-stone.png', 'mega-boost-pad.png','big-boost-pad.png', 'boost-pad.png', 'big-wooden-spike.png','big-bear-trap.png', 'bear-trap.png', 'mega-bear-trap.png', 'wooden-turret.png', 'big-resurrection-stone.png'];function enableDeleteMode() {isDeleteMode = true;isPlacing = false;selectedStructure = null;const cursor = document.getElementById('cursor');cursor.style.display = 'block';cursor.style.backgroundImage = 'url("https://taming.io/img/big-red-cross.png")';cursor.style.width = '30px';cursor.style.height = '30px';cursor.style.transform = `rotate(0deg)`;cursor.style.cursor = 'none';}function disableDeleteMode() {isDeleteMode = false;const cursor = document.getElementById('cursor');cursor.style.display = 'none';}function selectStructure(icon, index) {if (icon.classList.contains('delete-icon')) {enableDeleteMode();return;}if (icon.classList.contains('stone-color')) {disableDeleteMode();return;}disableDeleteMode();selectedStructure = `structure${index + 1}`;isPlacing = true;const cursor = document.getElementById('cursor');cursor.style.display = 'block';cursor.style.backgroundImage = getComputedStyle(icon).backgroundImage;cursor.style.width = '35px';cursor.style.height = '35px';cursor.style.backgroundSize = 'contain';cursor.style.backgroundPosition = 'center';currentRotation = 0;cursor.style.transform = `rotate(${currentRotation}deg)`;cursor.style.zIndex = '9999';cursor.style.cursor = 'none';}function handleContentClick(e) {if (isDeleteMode) {const clickedElement = document.elementFromPoint(e.clientX, e.clientY);if (clickedElement && clickedElement.classList.contains('structure')) {clickedElement.remove();}} else if (isPlacing && selectedStructure) {const contentRect = document.getElementById('content').getBoundingClientRect();const newLeft = (e.clientX - contentRect.left) - 20;const newTop = (e.clientY - contentRect.top) - 20;const newStructure = document.createElement('div');newStructure.classList.add('structure', selectedStructure);newStructure.style.left = `${newLeft}px`;newStructure.style.top = `${newTop}px`;newStructure.style.width = '35px';newStructure.dataset.rotation = currentRotation;newStructure.style.transform = `rotate(${currentRotation}deg)`;newStructure.style.backgroundImage = document.getElementById('cursor').style.backgroundImage;newStructure.style.backgroundSize = 'contain';newStructure.style.backgroundPosition = 'center';document.getElementById('content').appendChild(newStructure);void newStructure.offsetWidth;newStructure.classList.add('show');}}function handleKeyPress(e) {if ((e.key === 'r' || e.key === 'ะบ') && isPlacing && selectedStructure && !isDeleteMode) {currentRotation = (currentRotation + 10) % 360;const cursor = document.getElementById('cursor');cursor.style.transform = `rotate(${currentRotation}deg)`;}}document.querySelectorAll('.icon').forEach((icon, index) => {icon.addEventListener('click', () => {if (icon.classList.contains('delete-icon')) {enableDeleteMode();} else {selectStructure(icon, index);}});});document.querySelector('.sidebar .delete-icon').addEventListener('click', enableDeleteMode);document.getElementById('content').addEventListener('click', handleContentClick);document.addEventListener('keydown', handleKeyPress);let currentMaterialIndex = 0;document.querySelector('.icon.stone-color').addEventListener('click', () => {const materials = ['wooden', 'stone', 'golden', 'ruby', 'amethyst', 'sapphire', 'amber', 'diamond', 'emerald'];currentMaterialIndex = (currentMaterialIndex + 1) % materials.length;setStructureIcons(materials[currentMaterialIndex]);});function setStructureIcons(material) {structureIcons.forEach((icon, index) => {const element = document.querySelector(`.icon.structure${index + 1}-icon`);if (element) {const newIcon = icon.includes('wooden') ? icon.replace('wooden', material) : icon;const currentBackgroundImage = getComputedStyle(element).backgroundImage;const newBackgroundImage = `url('https://taming.io/img/world/${newIcon}')`;if (currentBackgroundImage !== newBackgroundImage) {element.style.backgroundImage = newBackgroundImage;}}});}setStructureIcons('wooden');document.addEventListener('mousemove', (e) => {const cursor = document.getElementById('cursor');cursor.style.left = `${e.pageX - 20}px`;cursor.style.top = `${e.pageY - 20}px`;if (cursor.style.backgroundImage && cursor.style.backgroundImage !== 'none') {cursor.style.cursor = 'none';} else {cursor.style.cursor = 'auto';}});document.querySelector('.icon-panel').addEventListener('mousemove', (e) => {const cursor = document.getElementById('cursor');cursor.style.display = 'block';cursor.style.left = `${e.pageX - 20}px`;cursor.style.top = `${e.pageY - 20}px`;});function setRotation(angle) {currentRotation = angle;const cursor = document.getElementById('cursor');cursor.style.transform = `rotate(${currentRotation}deg)`;}document.addEventListener('keydown', (e) => {if ((e.key === 'r' || e.key === 'ะบ') && isPlacing && selectedStructure) {setRotation((currentRotation + 10) % 360);}});document.addEventListener('keydown', (e) => {if (e.ctrlKey) {if (['Equal', '+', 'Add', '=', 'Minus', '-'].includes(e.key)) {e.preventDefault();}}});document.addEventListener('wheel', (e) => {if (e.ctrlKey) {e.preventDefault();}}, { passive: false });